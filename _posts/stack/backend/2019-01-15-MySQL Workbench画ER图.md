---
title: "MySQL Workbench画ER图"
categories:
  - backend
tags:
  - MySQL
classes: wide

excerpt: "使用Workbench画实体关系图"
---

`MySQL Workbench`是`MySQL`官方的可视化数据库设计工具，简单介绍Ubuntu平台下如何安装`MySQL Workbench`以及如何使用它画ER图

# 1 Workbench安装
Ubuntu下使用如下命令进行安装：
```
$ sudo apt-get update
$ sudo apt-get install mysql-workbench

$ mysql-workbench --version
MySQL Workbench CE (GPL) 6.3.6 CE build 511
```

# 2 ER图-》表
ER图，Entity Relationship Diagram，实体-关系图，侧面反应了关系型数据库的“关系”

这部分介绍如何在`Workbench`中设计ER图，并根据ER图，导出对应的`sql`数据库脚本文件

打开`Workbench`的欢迎界面如下：  
![开始](https://raw.githubusercontent.com/ZQQ1024/pictures/master/20190115155610.png)

`File->New Model`，然后添加ER图：  
![](https://raw.githubusercontent.com/ZQQ1024/pictures/master/20190115160456.png)

在数据库`mydb`中，添加表：  
![](https://raw.githubusercontent.com/ZQQ1024/pictures/master/20190115160635.png)

双击编辑表

我们添加一个用户`student`表，记录学生信息，如下图，包含如下`column`：
- sid: 主键，学号
- name: 名字
- age: 年龄
- sex: 性别
- class: 班级

![](https://raw.githubusercontent.com/ZQQ1024/pictures/master/20190115162813.png)

我们再添加一个课程表`course`，记录课程信息，如下图，包含如下`column`：
- cid: 主键，课程号
- name: 课程名
- score: 课程对应的学分

![](https://raw.githubusercontent.com/ZQQ1024/pictures/master/20190115163135.png)

我们再添加一个学生-课程成绩表`score`，记录学生们的课程成绩，如下图，包含如下`column`：
- cid: 主键，外键（引用自`course`.`cid`）
- sid: 主键，外键（引用自`student`.`sid`）
- score: 某个学生某个课程的得分



![](https://raw.githubusercontent.com/ZQQ1024/pictures/master/20190115163515.png)

最终的ER图也如上，即学生信息存在学生表中，课程信息存在课程表中，课程的课程号(cid)和学生的学号(sid)共同决定某个学生的某门课成绩，如学号20130529(name:zqq age:xx sex:xx)的同学课程号为1(name:物理)的课程成绩为59分

然后，`File->Export->Next->Next`选择导出`sql`文件：  
![](https://raw.githubusercontent.com/ZQQ1024/pictures/master/20190115164611.png)

sql文件如下：
```
-- MySQL Script generated by MySQL Workbench
-- 2019年01月15日 星期二 16时46分35秒
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`student`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`student` (
  `sid` INT NOT NULL,
  `name` VARCHAR(45) NULL,
  `age` INT NULL,
  `sex` VARCHAR(45) NULL,
  `class` VARCHAR(45) NULL,
  PRIMARY KEY (`sid`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`course`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`course` (
  `cid` INT NOT NULL,
  `name` VARCHAR(45) NULL,
  `score` VARCHAR(45) NULL,
  PRIMARY KEY (`cid`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`score`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`score` (
  `sid` INT NOT NULL,
  `cid` INT NOT NULL,
  `score` INT NULL,
  PRIMARY KEY (`sid`, `cid`),
  INDEX `fk_score_1_idx` (`cid` ASC),
  CONSTRAINT `fk_score_1`
    FOREIGN KEY (`cid`)
    REFERENCES `mydb`.`course` (`cid`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_score_2`
    FOREIGN KEY (`sid`)
    REFERENCES `mydb`.`student` (`sid`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
```

# 3 表-》ER图
如下图，我们已经在`mydb`数据库中有以下表了：  
![](https://raw.githubusercontent.com/ZQQ1024/pictures/master/20190115165516.png)

如何生成上述的ER图呢？

点击`Database->Reverse Engineer`，然后链接，选择相关数据库`mydb`就可以了

![](https://raw.githubusercontent.com/ZQQ1024/pictures/master/20190115165925.png)


# 4 References
> [https://jingyan.baidu.com/article/a65957f4d533eb24e77f9b42.html](https://jingyan.baidu.com/article/a65957f4d533eb24e77f9b42.html)  
[https://blog.csdn.net/it_nqr/article/details/77773643](https://blog.csdn.net/it_nqr/article/details/77773643)  
[https://stackoverflow.com/questions/3663952/what-do-column-flags-mean-in-mysql-workbench](https://stackoverflow.com/questions/3663952/what-do-column-flags-mean-in-mysql-workbench)  
[https://www.jianshu.com/p/394f8aa724f4](https://www.jianshu.com/p/394f8aa724f4)  